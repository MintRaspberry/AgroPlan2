{% extends "base.html" %}

{% block title %}–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ AgroPlan{% endblock %}

{% block body_class %}auth-page{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <div class="auth-header">
            <a href="/" class="auth-logo">
                <div class="logo-gradient">üå±</div>
                <span>Agro<span>Plan</span></span>
            </a>
            <h1>–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</h1>
            <p>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ AgroPlan —Å–µ–≥–æ–¥–Ω—è</p>
        </div>

        <form class="auth-form" method="POST" action="/register">
            {% if error %}
            <div class="alert alert-error">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z" clip-rule="evenodd"/>
                </svg>
                {{ error }}
            </div>
            {% endif %}

            <div class="form-row">
                <div class="form-group">
                    <label for="firstName" class="form-label">–ò–º—è</label>
                    <div class="input-wrapper">
                        <input type="text" id="firstName" name="firstName" class="form-input" placeholder="–í–∞—à–µ –∏–º—è" required>
                        <svg class="input-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 8a3 3 0 100-6 3 3 0 000 6zM3.465 14.493a1.23 1.23 0 00.41 1.412A9.957 9.957 0 0010 18c2.31 0 4.438-.784 6.131-2.1.43-.333.604-.903.408-1.41a7.002 7.002 0 00-13.074.003z"/>
                        </svg>
                    </div>
                </div>

                <div class="form-group">
                    <label for="lastName" class="form-label">–§–∞–º–∏–ª–∏—è</label>
                    <div class="input-wrapper">
                        <input type="text" id="lastName" name="lastName" class="form-input" placeholder="–í–∞—à–∞ —Ñ–∞–º–∏–ª–∏—è" required>
                        <svg class="input-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 8a3 3 0 100-6 3 3 0 000 6zM3.465 14.493a1.23 1.23 0 00.41 1.412A9.957 9.957 0 0010 18c2.31 0 4.438-.784 6.131-2.1.43-.333.604-.903.408-1.41a7.002 7.002 0 00-13.074.003z"/>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="email" class="form-label">Email</label>
                <div class="input-wrapper">
                    <input type="email" id="email" name="email" class="form-input" placeholder="your@email.com" required>
                    <svg class="input-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M3 4a2 2 0 00-2 2v1.161l8.441 4.221a1.25 1.25 0 001.118 0L19 7.162V6a2 2 0 00-2-2H3z"/>
                        <path d="M19 8.839l-7.77 3.885a2.75 2.75 0 01-2.46 0L1 8.839V14a2 2 0 002 2h14a2 2 0 002-2V8.839z"/>
                    </svg>
                </div>
            </div>

            <div class="form-group">
                <label for="password" class="form-label">–ü–∞—Ä–æ–ª—å</label>
                <div class="input-wrapper">
                    <input type="password" id="password" name="password" class="form-input" placeholder="–°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                    <svg class="input-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z" clip-rule="evenodd"/>
                    </svg>
                    <button type="button" class="password-toggle" id="passwordToggle">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" class="eye-open">
                            <path d="M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"/>
                            <path fill-rule="evenodd" d="M.664 10.59a1.651 1.651 0 010-1.186A10.004 10.004 0 0110 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0110 17c-4.257 0-7.893-2.66-9.336-6.41zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"/>
                        </svg>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" class="eye-closed" style="display: none;">
                            <path fill-rule="evenodd" d="M3.28 2.22a.75.75 0 00-1.06 1.06l14.5 14.5a.75.75 0 101.06-1.06l-1.745-1.745a10.029 10.029 0 003.3-4.38 1.651 1.651 0 000-1.185A10.004 10.004 0 009.999 3a9.956 9.956 0 00-4.744 1.194L3.28 2.22zM7.752 6.69l1.092 1.092a2.5 2.5 0 013.374 3.373l1.091 1.092A4 4 0 007.752 6.69z" clip-rule="evenodd"/>
                            <path d="M10.748 13.93l2.523 2.523a9.987 9.987 0 01-3.27.547c-4.258 0-7.894-2.66-9.337-6.41a1.651 1.651 0 010-1.186A10.007 10.007 0 012.839 6.02L6.07 9.252a4 4 0 004.678 4.678z"/>
                        </svg>
                    </button>
                </div>
                <div class="password-strength" id="passwordStrength">
                    <div class="strength-bar">
                        <div class="strength-fill" id="strengthFill"></div>
                    </div>
                    <span class="strength-text" id="strengthText">–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª—è</span>
                </div>
            </div>

            <div class="form-group">
                <label for="confirmPassword" class="form-label">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                <div class="input-wrapper">
                    <input type="password" id="confirmPassword" name="confirmPassword" class="form-input" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                    <svg class="input-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M16.403 12.652a3 3 0 000-5.304 3 3 0 00-3.75-3.751 3 3 0 00-5.305 0 3 3 0 00-3.751 3.75 3 3 0 000 5.305 3 3 0 003.75 3.751 3 3 0 005.305 0 3 3 0 003.751-3.75zm-2.546-4.46a.75.75 0 00-1.214-.883l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd"/>
                    </svg>
                </div>
            </div>

            <div class="form-group">
                <label class="checkbox-wrapper">
                    <input type="checkbox" name="agreeTerms" id="agreeTerms" required>
                    <span class="checkmark"></span>
                    <span class="checkbox-label">
                        –Ø —Å–æ–≥–ª–∞—à–∞—é—Å—å —Å <a href="/terms" target="_blank">—É—Å–ª–æ–≤–∏—è–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a> 
                        –∏ <a href="/privacy" target="_blank">–ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                    </span>
                </label>
            </div>

            <div class="form-group">
                <label class="checkbox-wrapper">
                    <input type="checkbox" name="newsletter" id="newsletter">
                    <span class="checkmark"></span>
                    <span class="checkbox-label">
                        –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                    </span>
                </label>
            </div>

            <button type="submit" class="btn btn-primary btn-full btn-large" id="submitBtn">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
        </form>

        <div class="auth-divider">
            <span>–∏–ª–∏</span>
        </div>

        <div class="social-auth">
            <button type="button" class="btn btn-outline btn-full social-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                </svg>
                –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å Google
            </button>
        </div>

        <div class="auth-footer">
            <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="/login" class="auth-link">–í–æ–π—Ç–∏</a></p>
        </div>
    </div>

    <div class="auth-background">
        <div class="auth-background-content">
            <div class="floating-card card-1">
                <div class="card-icon">üöú</div>
                <h3>–î–ª—è —Ñ–µ—Ä–º–µ—Ä–æ–≤</h3>
                <p>–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ —Ä–∞–±–æ—Ç—É –≤–∞—à–µ–≥–æ —Ö–æ–∑—è–π—Å—Ç–≤–∞</p>
            </div>
            <div class="floating-card card-2">
                <div class="card-icon">üåç</div>
                <h3>–≠–∫–æ–ª–æ–≥–∏—á–Ω–æ</h3>
                <p>–ó–∞–±–æ—Ç—å—Ç–µ—Å—å –æ –ø–ª–æ–¥–æ—Ä–æ–¥–∏–∏ –ø–æ—á–≤—ã</p>
            </div>
            <div class="floating-card card-3">
                <div class="card-icon">üí∞</div>
                <h3>–≠–∫–æ–Ω–æ–º–∏—è</h3>
                <p>–°–Ω–∏–∂–∞–π—Ç–µ –∑–∞—Ç—Ä–∞—Ç—ã –∏ –ø–æ–≤—ã—à–∞–π—Ç–µ –¥–æ—Ö–æ–¥</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Password toggle
    const passwordToggle = document.getElementById('passwordToggle');
    const passwordInput = document.getElementById('password');
    const eyeOpen = passwordToggle.querySelector('.eye-open');
    const eyeClosed = passwordToggle.querySelector('.eye-closed');

    passwordToggle.addEventListener('click', function() {
        const isPassword = passwordInput.type === 'password';
        passwordInput.type = isPassword ? 'text' : 'password';
        eyeOpen.style.display = isPassword ? 'none' : 'block';
        eyeClosed.style.display = isPassword ? 'block' : 'none';
    });

    // Password strength indicator
    const passwordInput = document.getElementById('password');
    const strengthFill = document.getElementById('strengthFill');
    const strengthText = document.getElementById('strengthText');

    passwordInput.addEventListener('input', function() {
        const password = this.value;
        const strength = calculatePasswordStrength(password);
        
        strengthFill.className = 'strength-fill ' + strength.class;
        strengthFill.style.width = strength.percentage + '%';
        strengthText.textContent = strength.text;
    });

    function calculatePasswordStrength(password) {
        let score = 0;
        
        if (password.length >= 8) score++;
        if (password.length >= 12) score++;
        if (/[A-Z]/.test(password)) score++;
        if (/[a-z]/.test(password)) score++;
        if (/[0-9]/.test(password)) score++;
        if (/[^A-Za-z0-9]/.test(password)) score++;
        
        const classes = ['very-weak', 'weak', 'fair', 'good', 'strong', 'very-strong'];
        const texts = [
            '–û—á–µ–Ω—å —Å–ª–∞–±—ã–π',
            '–°–ª–∞–±—ã–π', 
            '–°—Ä–µ–¥–Ω–∏–π',
            '–•–æ—Ä–æ—à–∏–π',
            '–°–∏–ª—å–Ω—ã–π',
            '–û—á–µ–Ω—å —Å–∏–ª—å–Ω—ã–π'
        ];
        
        const index = Math.min(score, classes.length - 1);
        const percentage = (score / (classes.length - 1)) * 100;
        
        return {
            class: classes[index],
            text: texts[index],
            percentage: percentage
        };
    }

    // Form validation
    const form = document.querySelector('.auth-form');
    const submitBtn = document.getElementById('submitBtn');
    
    form.addEventListener('submit', function(e) {
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        
        if (password !== confirmPassword) {
            e.preventDefault();
            showError('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
            return;
        }
        
        if (password.length < 8) {
            e.preventDefault();
            showError('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤');
            return;
        }
        
        // Show loading state
        submitBtn.innerHTML = '<div class="button-spinner"></div>–°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞...';
        submitBtn.disabled = true;
    });

    function showError(message) {
        // Remove existing error
        const existingError = document.querySelector('.alert-error');
        if (existingError) {
            existingError.remove();
        }
        
        // Create new error
        const errorDiv = document.createElement('div');
        errorDiv.className = 'alert alert-error';
        errorDiv.innerHTML = `
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z" clip-rule="evenodd"/>
            </svg>
            ${message}
        `;
        
        form.insertBefore(errorDiv, form.firstChild);
        
        // Re-enable button
        submitBtn.innerHTML = '–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç';
        submitBtn.disabled = false;
    }
});
</script>
{% endblock %}
