{% extends "base.html" %}

{% block title %}–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä - AgroPlan{% endblock %}

{% block extra_css %}
<style>
.calculator-hero {
    background:
        radial-gradient(ellipse at 80% 20%, rgba(255, 215, 0, 0.2) 0%, transparent 50%),
        radial-gradient(ellipse at 20% 80%, rgba(100, 255, 218, 0.15) 0%, transparent 50%),
        var(--gradient-premium);
    border-radius: var(--radius-3xl);
    padding: 80px 60px;
    margin-bottom: 60px;
    position: relative;
    overflow: hidden;
    box-shadow: var(--shadow-luxury);
    border: 1px solid rgba(255, 215, 0, 0.1);
}

.calculator-hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle fill="%23ffd700" opacity="0.05" cx="50" cy="50" r="2"/></svg>');
    animation: float 25s infinite linear;
}

.calculator-form {
    background: rgba(23, 42, 69, 0.7);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 215, 0, 0.1);
    border-radius: var(--radius-2xl);
    padding: 50px;
    box-shadow: var(--shadow-elegant);
    margin-bottom: 60px;
    transition: all 0.4s var(--ease-smooth);
}

.calculator-form:hover {
    border-color: rgba(255, 215, 0, 0.2);
    box-shadow: var(--shadow-luxury);
}

.results-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 24px;
    margin: 40px 0;
}

.result-card {
    background: rgba(23, 42, 69, 0.8);
    border: 1px solid;
    border-radius: var(--radius-xl);
    padding: 32px;
    transition: all 0.4s var(--ease-smooth);
    position: relative;
    overflow: hidden;
    text-align: center;
}

.result-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: inherit;
    opacity: 0.6;
}

.result-card:hover {
    transform: translateY(-8px);
    box-shadow: var(--shadow-luxury);
}

.result-income {
    border-color: rgba(100, 255, 218, 0.3);
}

.result-income::before {
    background: var(--gradient-emerald);
}

.result-cost {
    border-color: rgba(239, 68, 68, 0.3);
}

.result-cost::before {
    background: linear-gradient(135deg, #ef4444 0%, #f87171 100%);
}

.result-profit {
    border-color: rgba(255, 215, 0, 0.3);
}

.result-profit::before {
    background: var(--gradient-gold);
}

.result-value {
    font-size: 2.5rem;
    font-weight: 800;
    margin-bottom: 8px;
    line-height: 1;
}

.result-label {
    font-size: 0.9rem;
    color: var(--light-slate);
    text-transform: uppercase;
    letter-spacing: 0.1em;
}

.positive {
    color: var(--emerald);
}

.negative {
    color: #ef4444;
}

.neutral {
    color: var(--gold);
}

.profitability-badge {
    display: inline-block;
    padding: 8px 16px;
    border-radius: var(--radius-full);
    font-weight: 600;
    font-size: 0.9rem;
    margin-top: 10px;
}

.profitability-high {
    background: rgba(100, 255, 218, 0.2);
    color: var(--emerald);
    border: 1px solid rgba(100, 255, 218, 0.3);
}

.profitability-medium {
    background: rgba(255, 215, 0, 0.2);
    color: var(--gold);
    border: 1px solid rgba(255, 215, 0, 0.3);
}

.profitability-low {
    background: rgba(239, 68, 68, 0.2);
    color: #ef4444;
    border: 1px solid rgba(239, 68, 68, 0.3);
}

.crop-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin: 30px 0;
}

.crop-info-item {
    background: rgba(255, 255, 255, 0.05);
    padding: 20px;
    border-radius: var(--radius-lg);
    text-align: center;
}

.crop-info-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--gold);
    margin-bottom: 8px;
}

.crop-info-label {
    font-size: 0.8rem;
    color: var(--light-slate);
    text-transform: uppercase;
    letter-spacing: 0.1em;
}

@media (max-width: 768px) {
    .calculator-hero {
        padding: 60px 32px;
    }

    .calculator-form {
        padding: 32px 24px;
    }

    .results-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}

{% block content %}
<!-- –ü—Ä–µ–º–∏—É–º –≥–µ—Ä–æ–π -->
<section class="calculator-hero">
    <div class="container">
        <h1 class="hero-title">üßÆ –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h1>
        <p class="hero-subtitle">
            –¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–±—ã–ª–∏ –≤–∞—à–µ–≥–æ —Ö–æ–∑—è–π—Å—Ç–≤–∞
        </p>
    </div>
</section>

<!-- –§–æ—Ä–º–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ -->
<section class="calculator-form">
    <div class="container">
        <h2 class="section-title">–†–∞—Å—á–µ—Ç –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏</h2>

        <form method="post" action="/calculator">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; margin-bottom: 40px;">
                <div class="form-group">
                    <label for="crop" class="form-label">–°–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω–∞—è –∫—É–ª—å—Ç—É—Ä–∞</label>
                    <select id="crop" name="crop" required class="form-select">
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫—É–ª—å—Ç—É—Ä—É --</option>
                        <option value="–ø—à–µ–Ω–∏—Ü–∞" {% if crop =='–ø—à–µ–Ω–∏—Ü–∞' %}selected{% endif %}>–ü—à–µ–Ω–∏—Ü–∞</option>
                        <option value="–∫–∞—Ä—Ç–æ—Ñ–µ–ª—å" {% if crop =='–∫–∞—Ä—Ç–æ—Ñ–µ–ª—å' %}selected{% endif %}>–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å</option>
                        <option value="–ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫" {% if crop =='–ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫' %}selected{% endif %}>–ü–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫</option>
                        <option value="–≥–æ—Ä–æ—Ö" {% if crop =='–≥–æ—Ä–æ—Ö' %}selected{% endif %}>–ì–æ—Ä–æ—Ö</option>
                        <option value="—è—á–º–µ–Ω—å" {% if crop =='—è—á–º–µ–Ω—å' %}selected{% endif %}>–Ø—á–º–µ–Ω—å</option>
                        <option value="–∫—É–∫—É—Ä—É–∑–∞" {% if crop =='–∫—É–∫—É—Ä—É–∑–∞' %}selected{% endif %}>–ö—É–∫—É—Ä—É–∑–∞</option>
                        <option value="–æ–≤—ë—Å" {% if crop =='–æ–≤—ë—Å' %}selected{% endif %}>–û–≤—ë—Å</option>
                        <option value="—Å–æ—è" {% if crop =='—Å–æ—è' %}selected{% endif %}>–°–æ—è</option>
                        <option value="—Ä–æ–∂—å" {% if crop =='—Ä–æ–∂—å' %}selected{% endif %}>–†–æ–∂—å</option>
                        <option value="–≥—Ä–µ—á–∏—Ö–∞" {% if crop =='–≥—Ä–µ—á–∏—Ö–∞' %}selected{% endif %}>–ì—Ä–µ—á–∏—Ö–∞</option>
                        <option value="–ª—ë–Ω" {% if crop =='–ª—ë–Ω' %}selected{% endif %}>–õ—ë–Ω</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="area" class="form-label">–ü–ª–æ—â–∞–¥—å –ø–æ—Å–µ–≤–∞ (–≥–µ–∫—Ç–∞—Ä—ã)</label>
                    <input type="number" id="area" name="area" step="0.1" min="0.1" required
                           class="form-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 10.5"
                           value="{{ area if area else '' }}">
                </div>
            </div>

            <div style="text-align: center;">
                <button type="submit" class="btn btn-primary btn-large">
                    <span style="font-size: 1.2em;">üßÆ</span>
                    <span>–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å</span>
                </button>
            </div>
        </form>
    </div>
</section>

<!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞ -->
{% if calculation %}
<section class="calculator-form">
    <div class="container">
        <h2 class="section-title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è {{ crop }}</h2>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—É–ª—å—Ç—É—Ä–µ -->
        <div class="crop-info-grid">
            <div class="crop-info-item">
                <div class="crop-info-value">{{ "%.1f"|format(area) }} –≥–∞</div>
                <div class="crop-info-label">–ü–ª–æ—â–∞–¥—å –ø–æ—Å–µ–≤–∞</div>
            </div>
            <div class="crop-info-item">
                <div class="crop-info-value">{{ "{:,.0f}".format(cost_per_ha|int) }} ‚ÇΩ</div>
                <div class="crop-info-label">–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ 1 –≥–∞</div>
            </div>
            <div class="crop-info-item">
                <div class="crop-info-value">{{ "{:,.0f}".format(income_per_ha|int) }} ‚ÇΩ</div>
                <div class="crop-info-label">–î–æ—Ö–æ–¥ —Å 1 –≥–∞</div>
            </div>
            <div class="crop-info-item">
                <div class="crop-info-value">{{ "{:,.0f}".format((income_per_ha - cost_per_ha)|int) }} ‚ÇΩ</div>
                <div class="crop-info-label">–ü—Ä–∏–±—ã–ª—å —Å 1 –≥–∞</div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
        <div class="results-grid">
            <div class="result-card result-cost">
                <div class="result-value negative">{{ "{:,.0f}".format(total_cost|int) }} ‚ÇΩ</div>
                <div class="result-label">–û–±—â–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã</div>
                <p style="color: var(--light-slate); margin-top: 12px; font-size: 0.9rem;">
                    –í–∫–ª—é—á–∞—è —Å–µ–º–µ–Ω–∞, —É–¥–æ–±—Ä–µ–Ω–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ —É–±–æ—Ä–∫—É
                </p>
            </div>

            <div class="result-card result-income">
                <div class="result-value positive">{{ "{:,.0f}".format(total_income|int) }} ‚ÇΩ</div>
                <div class="result-label">–û–∂–∏–¥–∞–µ–º—ã–π –¥–æ—Ö–æ–¥</div>
                <p style="color: var(--light-slate); margin-top: 12px; font-size: 0.9rem;">
                    –ù–∞ –æ—Å–Ω–æ–≤–µ —Å—Ä–µ–¥–Ω–µ—Ä—ã–Ω–æ—á–Ω—ã—Ö —Ü–µ–Ω
                </p>
            </div>

            <div class="result-card result-profit">
                <div class="result-value {% if profit > 0 %}positive{% else %}negative{% endif %}">
                    {{ "{:,.0f}".format(profit|int) }} ‚ÇΩ
                </div>
                <div class="result-label">–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å</div>
                {% if profit > 0 %}
                <div class="profitability-badge profitability-high">
                    ‚úÖ –ü—Ä–∏–±—ã–ª—å–Ω—ã–π
                </div>
                {% else %}
                <div class="profitability-badge profitability-low">
                    ‚ùå –£–±—ã—Ç–æ—á–Ω—ã–π
                </div>
                {% endif %}
            </div>

            <div class="result-card">
                <div class="result-value neutral">{{ "%.1f"|format(profitability) }}%</div>
                <div class="result-label">–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å</div>
                {% if profitability > 20 %}
                <div class="profitability-badge profitability-high">
                    üöÄ –í—ã—Å–æ–∫–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å
                </div>
                {% elif profitability > 10 %}
                <div class="profitability-badge profitability-medium">
                    ‚ö° –°—Ä–µ–¥–Ω—è—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å
                </div>
                {% else %}
                <div class="profitability-badge profitability-low">
                    üìâ –ù–∏–∑–∫–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å
                </div>
                {% endif %}
            </div>
        </div>

        <!-- –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ -->
        <div class="card" style="background: rgba(255, 215, 0, 0.05); border-color: rgba(255, 215, 0, 0.2); margin-top: 30px;">
            <h3 style="text-align: center; margin-bottom: 24px;">üìä –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                <div style="text-align: center;">
                    <div style="font-size: 1.2rem; font-weight: 700; color: var(--emerald);">{{ "{:,.0f}".format(cost_per_ha|int) }} ‚ÇΩ/–≥–∞</div>
                    <div style="font-size: 0.8rem; color: var(--light-slate);">–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –≥–µ–∫—Ç–∞—Ä</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 1.2rem; font-weight: 700; color: var(--emerald);">{{ "{:,.0f}".format(income_per_ha|int) }} ‚ÇΩ/–≥–∞</div>
                    <div style="font-size: 0.8rem; color: var(--light-slate);">–î–æ—Ö–æ–¥ —Å –≥–µ–∫—Ç–∞—Ä–∞</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 1.2rem; font-weight: 700; color: var(--emerald);">{{ "{:,.0f}".format((income_per_ha - cost_per_ha)|int) }} ‚ÇΩ/–≥–∞</div>
                    <div style="font-size: 0.8rem; color: var(--light-slate);">–ü—Ä–∏–±—ã–ª—å —Å –≥–µ–∫—Ç–∞—Ä–∞</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 1.2rem; font-weight: 700; color: var(--emerald);">{{ "%.1f"|format(profitability) }}%</div>
                    <div style="font-size: 0.8rem; color: var(--light-slate);">–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å</div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ -->
<section>
    <div class="container">
        <div class="card" style="background: linear-gradient(135deg, rgba(255, 243, 205, 0.1), rgba(255, 234, 167, 0.1)); border: 1px solid rgba(255, 215, 0, 0.2);">
            <h3 style="text-align: center; margin-bottom: 16px;">‚ÑπÔ∏è –û –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ</h3>
            <p style="text-align: center; color: var(--light-slate); margin-bottom: 16px;">
                –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ä–µ–¥–Ω–µ—Ä—ã–Ω–æ—á–Ω—ã–µ —Ü–µ–Ω—ã –Ω–∞ —Å–µ–º–µ–Ω–∞, —É–¥–æ–±—Ä–µ–Ω–∏—è, —Å—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞—â–∏—Ç—ã —Ä–∞—Å—Ç–µ–Ω–∏–π –∏ –≥–æ—Ç–æ–≤—É—é –ø—Ä–æ–¥—É–∫—Ü–∏—é.
            </p>
            <p style="text-align: center; color: var(--gold); font-weight: 600;">
                üí° –í–Ω–∏–º–∞–Ω–∏–µ: —Ä–∞—Å—á–µ—Ç—ã —è–≤–ª—è—é—Ç—Å—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–º–∏. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –∏ –¥–æ—Ö–æ–¥—ã –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–≥–∏–æ–Ω–∞, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è –∏ —Ä—ã–Ω–æ—á–Ω–æ–π –∫–æ–Ω—ä—é–Ω–∫—Ç—É—Ä—ã.
            </p>
        </div>
    </div>
</section>
{% endblock %}